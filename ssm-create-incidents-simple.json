{
  "commands": [
    "echo 'Creating incidents table...'",
    "PGPASSWORD='Stacey1122' psql -h codingeverest-new.cl4qcomc6fj0.eu-west-1.rds.amazonaws.com -U postgres -d MiloDB <<'EOF'",
    "CREATE TABLE IF NOT EXISTS incidents (",
    "    id SERIAL PRIMARY KEY,",
    "    incident_number VARCHAR(50) NOT NULL UNIQUE,",
    "    subject VARCHAR(200) NOT NULL,",
    "    description TEXT,",
    "    requester_id INTEGER NOT NULL,",
    "    agent_id INTEGER,",
    "    group_id INTEGER,",
    "    department VARCHAR(100),",
    "    status VARCHAR(50) NOT NULL DEFAULT 'New',",
    "    priority VARCHAR(50) NOT NULL DEFAULT 'Low',",
    "    urgency VARCHAR(50),",
    "    impact VARCHAR(50),",
    "    source VARCHAR(50),",
    "    category VARCHAR(100),",
    "    sub_category VARCHAR(100),",
    "    created_at TIMESTAMP NOT NULL DEFAULT NOW(),",
    "    updated_at TIMESTAMP,",
    "    resolved_at TIMESTAMP,",
    "    closed_at TIMESTAMP,",
    "    planned_start_date TIMESTAMP,",
    "    planned_end_date TIMESTAMP,",
    "    planned_effort VARCHAR(50),",
    "    first_response_due TIMESTAMP,",
    "    resolution_due TIMESTAMP,",
    "    first_response_at TIMESTAMP,",
    "    tags VARCHAR(500),",
    "    associated_assets TEXT,",
    "    project_id INTEGER,",
    "    attachments TEXT,",
    "    resolution TEXT",
    ");",
    "CREATE INDEX IF NOT EXISTS ix_incidents_incident_number ON incidents(incident_number);",
    "CREATE INDEX IF NOT EXISTS ix_incidents_status ON incidents(status);",
    "CREATE INDEX IF NOT EXISTS ix_incidents_priority ON incidents(priority);",
    "CREATE INDEX IF NOT EXISTS ix_incidents_created_at ON incidents(created_at);",
    "CREATE INDEX IF NOT EXISTS ix_incidents_project_id ON incidents(project_id);",
    "CREATE INDEX IF NOT EXISTS ix_incidents_requester_id ON incidents(requester_id);",
    "EOF",
    "echo ''",
    "echo 'Verifying table creation...'",
    "PGPASSWORD='Stacey1122' psql -h codingeverest-new.cl4qcomc6fj0.eu-west-1.rds.amazonaws.com -U postgres -d MiloDB -c \"SELECT COUNT(*) as table_exists FROM information_schema.tables WHERE table_name = 'incidents';\"",
    "echo ''",
    "echo 'Table structure:'",
    "PGPASSWORD='Stacey1122' psql -h codingeverest-new.cl4qcomc6fj0.eu-west-1.rds.amazonaws.com -U postgres -d MiloDB -c '\\d incidents'",
    "echo ''",
    "echo 'Database table creation complete!'"
  ]
}
