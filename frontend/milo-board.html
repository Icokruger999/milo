<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Milo Board - Project Management">
    <title>Milo Board - Coding Everest</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            padding: 0;
            background: var(--bg-secondary);
        }

        .board-header {
            background: var(--bg-primary);
            border-bottom: 1px solid var(--border-color);
            padding: 12px 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .board-header-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .board-logo {
            width: 32px;
            height: 32px;
            background: var(--primary-blue);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .board-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .board-header-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 3px;
            transition: background 0.15s ease;
        }

        .user-menu:hover {
            background: var(--bg-secondary);
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--primary-blue);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 14px;
        }

        .board-container {
            display: flex;
            height: calc(100vh - 56px);
        }

        .board-sidebar {
            width: 240px;
            background: var(--bg-primary);
            border-right: 1px solid var(--border-color);
            padding: 16px;
            overflow-y: auto;
        }

        .sidebar-section {
            margin-bottom: 24px;
        }

        .sidebar-section-title {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--text-tertiary);
            letter-spacing: 0.05em;
            margin-bottom: 8px;
            padding: 0 8px;
        }

        .sidebar-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
            border-radius: 3px;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 14px;
            transition: background 0.15s ease;
            cursor: pointer;
        }

        .sidebar-item:hover {
            background: var(--bg-secondary);
        }

        .sidebar-item.active {
            background: var(--primary-blue-light);
            color: var(--primary-blue);
            font-weight: 500;
        }

        .board-main {
            flex: 1;
            padding: 24px;
            overflow-x: auto;
            overflow-y: auto;
        }

        .board-columns {
            display: flex;
            gap: 16px;
            min-width: fit-content;
        }

        .board-column {
            width: 300px;
            min-width: 300px;
            background: var(--bg-tertiary);
            border-radius: 8px;
            padding: 16px;
            display: flex;
            flex-direction: column;
        }

        .column-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
        }

        .column-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .column-count {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 2px 8px;
            font-size: 12px;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .column-items {
            display: flex;
            flex-direction: column;
            gap: 8px;
            flex: 1;
        }

        .task-card {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 12px;
            cursor: pointer;
            transition: box-shadow 0.15s ease, transform 0.15s ease;
        }

        .task-card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-1px);
        }

        .task-title {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 8px;
            line-height: 1.4;
        }

        .task-meta {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
        }

        .task-label {
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 11px;
            font-weight: 500;
        }

        .task-label.billing { background: #E3FCEF; color: #006644; }
        .task-label.accounts { background: #DEEBFF; color: #0052CC; }
        .task-label.forms { background: #FFF4E5; color: #974F00; }
        .task-label.feedback { background: #F4F5F7; color: #42526E; }

        .task-id {
            font-size: 11px;
            color: var(--text-tertiary);
            font-family: monospace;
        }

        .task-footer {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 8px;
        }

        .task-assignee {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--primary-blue);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: 600;
        }

        .task-icons {
            display: flex;
            gap: 4px;
            align-items: center;
        }

        .task-icon {
            width: 16px;
            height: 16px;
            color: var(--text-tertiary);
        }

        .add-task-btn {
            margin-top: 8px;
            padding: 8px;
            background: transparent;
            border: 1px dashed var(--border-color);
            border-radius: 3px;
            color: var(--text-secondary);
            font-size: 14px;
            cursor: pointer;
            transition: border-color 0.15s ease, color 0.15s ease;
        }

        .add-task-btn:hover {
            border-color: var(--border-hover);
            color: var(--text-primary);
        }

        .dropdown-menu {
            position: absolute;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            box-shadow: var(--shadow-lg);
            padding: 8px 0;
            min-width: 160px;
            display: none;
            z-index: 1000;
        }

        .dropdown-menu.show {
            display: block;
        }

        .dropdown-item {
            padding: 8px 16px;
            font-size: 14px;
            color: var(--text-primary);
            cursor: pointer;
            transition: background 0.15s ease;
        }

        .dropdown-item:hover {
            background: var(--bg-secondary);
        }
    </style>
</head>
<body>
    <!-- Board Header -->
    <div class="board-header">
        <div class="board-header-left">
            <div class="board-logo">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="9" y1="3" x2="9" y2="21"></line>
                    <line x1="3" y1="9" x2="21" y2="9"></line>
                </svg>
            </div>
            <div class="board-title">Milo Board</div>
        </div>
        <div class="board-header-right">
            <div class="user-menu" id="userMenu">
                <div class="user-avatar" id="userAvatar">SU</div>
                <span id="userName">User</span>
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M6 9l6 6 6-6"></path>
                </svg>
            </div>
        </div>
    </div>

    <!-- Board Container -->
    <div class="board-container">
        <!-- Sidebar -->
        <div class="board-sidebar">
            <div class="sidebar-section">
                <div class="sidebar-section-title">Planning</div>
                <div class="sidebar-item active">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                    </svg>
                    Board
                </div>
                <div class="sidebar-item">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 11l3 3L22 4"></path>
                        <path d="M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11"></path>
                    </svg>
                    Backlog
                </div>
                <div class="sidebar-item">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="20" x2="12" y2="4"></line>
                        <path d="M3 20c0-5 4-9 9-9s9 4 9 9"></path>
                    </svg>
                    Reports
                </div>
            </div>
            <div class="sidebar-section">
                <div class="sidebar-section-title">Development</div>
                <div class="sidebar-item">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 16V8a2 2 0 00-1-1.73l-7-4a2 2 0 00-2 0l-7 4A2 2 0 003 8v8a2 2 0 001 1.73l7 4a2 2 0 002 0l7-4A2 2 0 0021 16z"></path>
                    </svg>
                    Code
                </div>
            </div>
        </div>

        <!-- Main Board -->
        <div class="board-main">
            <div class="board-columns">
                <!-- TO DO Column -->
                <div class="board-column">
                    <div class="column-header">
                        <div class="column-title">TO DO</div>
                        <div class="column-count" id="todoCount">0</div>
                    </div>
                    <div class="column-items" id="todoItems"></div>
                    <button class="add-task-btn" onclick="addTask('todo')">+ Add a task</button>
                </div>

                <!-- IN PROGRESS Column -->
                <div class="board-column">
                    <div class="column-header">
                        <div class="column-title">IN PROGRESS</div>
                        <div class="column-count" id="progressCount">0</div>
                    </div>
                    <div class="column-items" id="progressItems"></div>
                    <button class="add-task-btn" onclick="addTask('progress')">+ Add a task</button>
                </div>

                <!-- IN REVIEW Column -->
                <div class="board-column">
                    <div class="column-header">
                        <div class="column-title">IN REVIEW</div>
                        <div class="column-count" id="reviewCount">0</div>
                    </div>
                    <div class="column-items" id="reviewItems"></div>
                    <button class="add-task-btn" onclick="addTask('review')">+ Add a task</button>
                </div>

                <!-- DONE Column -->
                <div class="board-column">
                    <div class="column-header">
                        <div class="column-title">DONE</div>
                        <div class="column-count" id="doneCount">0</div>
                    </div>
                    <div class="column-items" id="doneItems"></div>
                    <button class="add-task-btn" onclick="addTask('done')">+ Add a task</button>
                </div>
            </div>
        </div>
    </div>

    <script src="js/config.js"></script>
    <script src="js/api-client.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/board.js"></script>
    <script>
        // Check authentication and password change requirement
        if (!authService.isAuthenticated()) {
            window.location.href = 'milo-login.html';
        } else if (authService.requiresPasswordChange()) {
            const user = authService.getCurrentUser();
            if (user && user.email) {
                window.location.href = `milo-change-password.html?email=${encodeURIComponent(user.email)}`;
            } else {
                window.location.href = 'milo-login.html';
            }
        }
    </script>
</body>
</html>

