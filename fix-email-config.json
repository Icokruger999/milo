{
  "InstanceIds": ["i-06bc5b2218c041802"],
  "DocumentName": "AWS-RunShellScript",
  "Parameters": {
    "commands": [
      "echo 'Backing up appsettings.json...'",
      "sudo cp /home/ec2-user/milo-backend-publish/appsettings.json /home/ec2-user/milo-backend-publish/appsettings.json.backup-$(date +%Y%m%d-%H%M%S)",
      "echo 'Updating UseSes to false...'",
      "sudo sed -i 's/\"UseSes\": true/\"UseSes\": false/g' /home/ec2-user/milo-backend-publish/appsettings.json",
      "echo 'Updating FromEmail to info@streamyo.net...'",
      "sudo sed -i 's/\"FromEmail\": \"info@codingeverest.com\"/\"FromEmail\": \"info@streamyo.net\"/g' /home/ec2-user/milo-backend-publish/appsettings.json",
      "echo 'Verifying changes...'",
      "cat /home/ec2-user/milo-backend-publish/appsettings.json | grep -A 10 Email",
      "echo 'Restarting service...'",
      "sudo systemctl restart milo-backend",
      "sleep 3",
      "sudo systemctl status milo-backend --no-pager",
      "curl -s http://localhost:8080/api/health"
    ]
  }
}
